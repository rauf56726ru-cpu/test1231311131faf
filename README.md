# Binance Chart Viewer

Проект свёрнут до минимального фронтенда и компактного API, которые отвечают за построение свечного графика и тестовую инспекцию данных, собранных на стороне клиента.

## Возможности
- Загрузка исторических свечей Binance для выбранного тикера и интервала.
- Отрисовка графика на базе Lightweight Charts: свечи, оси, масштабирование, навигация.
- Линия последней цены и краткая сводка по последней свече.
- Автозаполнение пропусков в данных через `ChartGapWatcher`.
- Живое обновление за счёт WebSocket-потока Binance.
- Кнопка «Inspection» формирует снимок текущего состояния свечей и открывает инспекционную панель на основе этих данных.
- REST-эндпоинты `/inspection/snapshot` и `/inspection`, работающие со снимками данных, без дополнительных запросов к внешним сервисам.

## Как запустить
1. Запустите приложение FastAPI, которое теперь также обслуживает фронтенд-график и статические файлы:
   ```bash
   uvicorn src.api.app:app --reload
   ```
   После запуска откройте в браузере `http://127.0.0.1:8000/` — загрузится страница графика `index.html`.

   Базовые ответы API:
   - `POST /inspection/snapshot` &mdash; принимает снимок с фронтенда и возвращает идентификатор `snapshot_id`:
   ```json
   { "snapshot_id": "snap-1711459200000-a1b2c3" }
   ```
   - `GET /inspection?snapshot=<ID>` &mdash; отдаёт HTML-дашборд. Для JSON-версии запросите с заголовком `Accept: application/json`:
   ```json
   {
     "DATA": {
       "ohlcv": {"symbol": "BTCUSDT", "tf": "1m", "candles": [...]},
       "meta": {"requested": {"symbol": "BTCUSDT", "tf": "1m"}}
     },
     "DIAGNOSTICS": {
       "snapshot_id": "snap-1711459200000-a1b2c3",
       "generated_at": "2024-03-26T12:00:00Z"
     }
   }
   ```
2. Введите тикер (например, `BTCUSDT`) и выберите интервал свечей. График автоматически загрузит историю и переключится в режим реального времени.

## Структура
- `public/` &mdash; JS/стили для графика (`app.js`, `binanceCandles.js`, `chart-gap-watcher.js`, `styles.css`).
- `templates/index.html` &mdash; единственная страница с графиком и панелью управления.
- `src/` &mdash; минимальный FastAPI-проект с обработчиками `/inspection/snapshot`, `/inspection`, `health`, `version` и вспомогательными модулями `services/`.
