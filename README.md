# Binance Chart Viewer

Проект свёрнут до минимального фронтенда и компактного API, которые отвечают только за построение свечного графика и получение исторических OHLCV-данных.

## Возможности
- Загрузка исторических свечей Binance для выбранного тикера и интервала.
- Отрисовка графика на базе Lightweight Charts: свечи, оси, масштабирование, навигация.
- Линия последней цены и краткая сводка по последней свече.
- Автозаполнение пропусков в данных через `ChartGapWatcher`.
- Живое обновление за счёт WebSocket-потока Binance.
- REST-эндпоинты `/ohlc`, `/delta`, `/vwap`, `/tpo` и сводный `/diagnostics`, возвращающие свечи, метрики дельты, VWAP и профили TPO.
- Документационная страница `/services` с описанием входных/выходных данных всех сервисов.

## Как запустить
1. Запустите приложение FastAPI, которое теперь также обслуживает фронтенд-график и статические файлы:
   ```bash
   uvicorn src.api.app:app --reload
   ```
   После запуска откройте в браузере `http://127.0.0.1:8000/` — загрузится страница графика `index.html`.

   Базовые ответы API остаются доступными:
   - `/ohlc` &mdash; исторические свечи и метаданные закрытия:
   ```json
   {
     "symbol": "BTCUSDT",
     "tf": "1m",
     "candles": [{"t": 1697049600000, "o": 1, "h": 1, "l": 1, "c": 1, "v": 1}],
     "last_price": 1,
     "last_ts": 1697049600000,
     "next_close_ts": 1697049660000,
     "time_to_close_ms": 5000
   }
   ```
   - `/tpo` &mdash; профиль объёмов и уровни value area по последним сессиям:
   ```json
   {
     "symbol": "BTCUSDT",
     "session": "ny",
     "requested_sessions": 5,
     "sessions": 5,
     "tpo": [{"date": "2024-03-25", "session": "ny", "VAL": 26950.5, "VAH": 27210.5, "POC": 27080.0}],
     "profile": [{"price": 27000.0, "volume": 125.4}]
   }
   ```
2. Введите тикер (например, `BTCUSDT`) и выберите интервал свечей. График автоматически загрузит историю и переключится в режим реального времени.

## Структура
- `public/` &mdash; JS/стили для графика (`app.js`, `binanceCandles.js`, `chart-gap-watcher.js`, `styles.css`).
- `templates/index.html` &mdash; единственная страница с графиком и панелью управления.
- `src/` &mdash; минимальный FastAPI-проект с обработчиками `/ohlc`, `/delta`, `/vwap`, `/tpo`, `/diagnostics`, `/services` и вспомогательными модулями `services/`.
